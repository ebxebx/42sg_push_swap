NAME      = push_swap
# TEST_CMD = ./$(NAME) 2 1 3 -111
# TEST_CMD = ./$(NAME) "2 1 3 -111"
# TEST_CMD = ./$(NAME) 1 2 3 -100 -1000
# TEST_CMD = ./$(NAME) 9 1 -10 -2 5 100
# TEST_CMD = ./$(NAME) "42 46 73 39 78 81 4 68 80 29 65 19 31 84 62 11 76 5 72 51 10 22 12 82 74 85 96 20 95 16 71 50 47 45 53 37 58 44 61 9 7 1 91 23 64 98 17 2 49 70 15 94 54 86 99 63 97 88 93 13 24 43 92 0 60 34 67 35 32 3 77 33 69 21 55 48 40 83 25 14 75 41 57 79 89 90 30 59 6 18 56 26 28 38 52 8 27 66 36 87"
TEST_CMD = ./$(NAME) "-225 123 104 -130 147 116 -143 -220 -216 37 112 31 -175 -81 236 207 -238 140 51 -3 25 107 -60 -199 -53 216 -45 -37 -55 -230 101 187 20 -51 169 -27 157 226 24 -156 198 -25 232 86 -138 55 148 -89 247 150 87 -19 -226 26 -120 -116 161 -105 -23 50 230 136 -169 38 -101 -183 228 183 82 69 -107 181 100 -108 -57 -114 -129 163 -79 10 121 109 -104 12 -140 34 11 132 165 -88 40 -76 77 151 43 -58 -218 4 138 243 215 175 -64 238 -229 -56 -224 32 234 159 -157 70 176 94 83 -217 -163 218 -208 122 85 -141 -170 -180 -93 97 -106 -144 189 88 -178 -173 237 -171 154 -247 84 6 44 -142 -165 30 68 222 99 124 21 -17 190 -158 -119 58 -41 -139 -233 60 180 166 179 -160 49 -201 -150 191 8 -83 182 -132 -70 57 67 -92 -127 -117 66 113 220 141 42 -250 131 -210 -211 -103 108 -155 -164 -215 -161 239 -192 47 -28 -10 -118 -66 22 78 45 160 -72 -67 -181 -190 170 133 117 200 -151 80 74 -205 35 106 172 -1 -73 -228 110 90 -111 -14 -65 -231 27 -47 -194 -236 -162 -30 -147 -209 29 5 -182 52 204 178 240 -8 76 129 144 64 118 171 -246 -50 -168 -36 98 211 13 -90 -15 -137 -44 -78 -22 197 -91 156 126 -32 -239 -29 -152 -98 134 202 -213 41 221 -179 -172 223 -243 209 -13 -35 249 28 -196 -18 23 152 -113 -176 -110 -86 -185 -148 224 -214 205 48 61 206 114 201 73 -193 227 63 193 -202 177 -95 146 -48 9 155 18 -84 -26 -62 -87 92 -121 -222 142 -187 244 -191 -212 -227 7 65 56 -52 -109 46 -122 149 -94 14 158 -188 62 -97 0 33 -11 -16 229 -40 102 -184 -115 245 115 219 -61 233 130 127 184 -244 -177 -197 248 174 -9 -6 186 -232 -174 36 -46 -21 89 -146 246 -166 -126 125 -235 167 137 -54 111 -77 199 -99 81 -5 -124 188 17 194 -241 196 -133 -195 -102 -123 -134 -153 -248 2 -31 93 -96 185 -203 -34 -68 -33 -223 -20 -167 162 168 3 173 153 208 -136 53 235 212 -69 -242 -245 -189 -100 19 -207 139 225 -39 195 -43 -237 241 -75 -159 217 -71 128 105 -7 -131 135 -12 75 120 71 91 -59 -125 143 -240 -221 -128 -219 -2 -4 59 -249 210 -49 242 119 1 -135 -24 16 -200 79 -154 54 -204 -85 -82 145 164 213 103 -42 231 96 -206 -149 -38 -63 72 -198 214 -74 -186 -112 39 192 15 -145 95 -234 -80 203"

LIBFT_DIR = ./libft
LIBFT     = $(LIBFT_DIR)/libft.a

SRCS = push_swap.c push_swap_utils.c move_stack.c push_swap_test.c \
		push_swap_greedy_insertion.c
OBJS = $(SRCS:.c=.o)

CC = cc
CFLAGS = -Wall -Wextra -Werror -I$(LIBFT_DIR) -g
LIBFT_FLAGS = -L$(LIBFT_DIR) -lft

# Add dependency flags and derived files
DEPFLAGS = -MMD -MP
DEPS = $(SRCS:.c=.d)

all: $(NAME)

test: $(NAME) $(LIBFT)
	$(TEST_CMD)

test2: $(NAME) $(LIBFT)
	valgrind --leak-check=full $(TEST_CMD)

$(NAME): $(OBJS) $(LIBFT)
	$(CC) $(CFLAGS) $(DEPFLAGS) $(OBJS) $(LIBFT_FLAGS) -o $(NAME)

$(LIBFT):
	$(MAKE) -C $(LIBFT_DIR)

# The Pattern Rule. 
%.o: %.c
	$(CC) $(CFLAGS) $(DEPFLAGS) -c $< -o $@

# include dependency files if they exist (don't error on first run)
-include $(DEPS)

clean:
	rm -f $(OBJS) $(DEPS)
	$(MAKE) -C $(LIBFT_DIR) clean

fclean: clean
	rm -f $(NAME)
	$(MAKE) -C $(LIBFT_DIR) fclean

re: fclean all

.PHONY: all clean fclean re
